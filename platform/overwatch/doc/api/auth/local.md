# Local
Authentication module using an username and password. This authentication method is based on JWTs (Json Web Tokens)
User are based on linto-admin component.

## Android Login
Used to collect information when android authentication is successful (authentication Token, refresh Token and mqtt information of the current stack).

**URL** : `/:LINTO_STACK_OVERWATCH_BASE_PATH/local/android/login/`

**Method** : `POST`

**Auth required** : NO

**Data constraints**
```json
{
    "username": "[valid email address]",
    "password": "[password in plain text]"
}
```

**Data example**
```json
{
    "username": "user@linto.ai",
    "password": "abcd1234"
}
```

### Success Response

**Code** : `202 Accepted`

**Info** Generate an `Android` token type

**Body Content**
```json
{
  "user": {
    "auth_token": "YYYYYYYYYYYYYYYYYYYYYYYYYYY",
    "refresh_token": "XXXXXXXXXXXXXXXXXXXXXXXXXXX",
    "expiration_date": 1597502813,
    "session_id": "5ee881b36915343d3dz16b13"
  },
  "mqtt": {
    "mqtt_host": "localhost",
    "mqtt_port": "1883",
    "mqtt_use_login": true,
    "mqtt_password": "password",
    "mqtt_login": "user"
  }
}
```

### Error Response

**Condition** : If 'username' and 'password' combination is wrong.

**Code** : `401 Unauthorized`

**Body Content** :
```
Unauthorized
```

## Android Refresh
Used to refresh the user token when expired (authentication Token, refresh Token and mqtt information of the current stack).

**URL** : `/:LINTO_STACK_OVERWATCH_BASE_PATH/local/android/refresh/`

**Method** : `POST`

**Auth required** : YES

**Data header constraints**

```
Authorization : Android auth_user_refresh_token
```
**Data header example**
```
Authorization : Android XXXXXXXXXXXXXXXXXXXXXXXXXXX
```

### Success Response

**Code** : `202 Accepted`

**Info** Generate an new `Android` token type

**Body Content**
```json
{
    "auth_token": "YYYYYYYYYYYYYYYYYYYYYYYYYYY",
    "refresh_token": "XXXXXXXXXXXXXXXXXXXXXXXXXXX",
    "expiration_date": 1597502813,
    "session_id": "5ee881b36915343d3dz16b13"
  }
}
```

### Error Response

**Condition** : If token is wrong

**Code** : `401 Unauthorized`

**Body Content** :
```
{
  "message": "The token is malformed"
}
```

## Web Login
Used to collect information when authentication is successful (authentication Token).

**URL** : `/:LINTO_STACK_OVERWATCH_BASE_PATH/local/web/login/`

**Method** : `POST`

**Auth required** : NO

**Data constraints**
```json
{
    "requestToken": "[Token generated by linto admin]",
}
```

**Data example**
```json
{
    "requestToken": "XXXXXXXXXXXXXXXX",
}
```

### Success Response

**Code** : `202 Accepted`

**Info** Generate an `WebApplication` token type

**Body Content**
```json
{
  "user": {
    "auth_token": "YYYYYYYYYYYYYYYYYYYYYYYYYYY"
  }
}
```

### Error Response

**Condition** : If 'requestToken' and 'url' combination is wrong.

**Code** : `401 Unauthorized`

**Body Content** :
```
Unauthorized
```

## Applications
Used to collect scopes for a registered User.

**URL** : `/:LINTO_STACK_OVERWATCH_BASE_PATH/local/applications/`

**Method** : `GET`

**Auth required** : YES

**Data header constraints**

```
Authorization : Android auth_user_token
```
**Data header example**
```
Authorization : Android XXXXXXXXXXXXXXXXXXXXXXXXXXX
```

### Success Response

**Code** : `200 OK`

**Body Content**
```json
[
  {
    "topic": "blk",
    "name": "Default",
    "description": "Default scope"
  },
  {
    "topic": "LNG",
    "name": "Linagora",
    "description": "A small description of the scope"
  }
]
```

### Error Response
#### Missing token
**Condition** : When token is missing

**Code** : `401 Unauthorized`

**Body Content** :

```json
{
  "message": "No authorization token was found"
}
```

#### Token invalid
**Condition** : If invalid token is send

**Code** : `401 Unauthorized`

**Body Content** :
```json
{
  "message": "Unexpected token x in JSON at position x"
}
```
#### Token expired
**Condition** : If token is expired

**Code** : `401 Unauthorized`

**Body Content** :
```json
{
  "message": "invalid exp value"
}
```
